
# py-tlgbotcore

**py-tlgbotcore** ‚Äî —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–µ —è–¥—Ä–æ Telegram-–±–æ—Ç–∞ –Ω–∞ Telethon —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞–≥–∏–Ω–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SQLite/CSV, –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å—é –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–µ–∫–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

> –í–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω [UniBorg](https://github.com/udf/uniborg). –î–ª—è Python 3.12+.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîå –ü–ª–∞–≥–∏–Ω—ã: —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —è–¥—Ä–∞
- üóÑÔ∏è –•—Ä–∞–Ω–∏–ª–∏—â–µ: SQLite –∏–ª–∏ CSV –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- üåç –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∫–∞–ª–µ–π (ru, en, ba, tt, ba_lat, tt_lat)
- üë• –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∏ —Ä–æ–ª—è–º–∏
- üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- üß© DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- üìù –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: type hints, ruff, mypy, pytest
- üê≥ Docker/Docker Compose-ready

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
py-tlgbotcore/
‚îú‚îÄ‚îÄ main.py                # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–ø—Ä–∏–º–µ—Ä)
‚îú‚îÄ‚îÄ dev_start.py           # –∑–∞–ø—É—Å–∫ –≤ dev-—Ä–µ–∂–∏–º–µ (DEBUG)
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ tlgbotcore/        # —è–¥—Ä–æ, DI, i18n, –º–æ–¥–µ–ª–∏, storage
‚îÇ   ‚îî‚îÄ‚îÄ plugins_bot/       # –ø–ª–∞–≥–∏–Ω—ã (—Å–º. –Ω–∏–∂–µ)
‚îÇ   ‚îî‚îÄ‚îÄ locales/           # json-—Ñ–∞–π–ª—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —è–∑—ã–∫–æ–≤
‚îú‚îÄ‚îÄ cfg/
‚îÇ   ‚îî‚îÄ‚îÄ config_tlg.py      # –≤–∞—à –∫–æ–Ω—Ñ–∏–≥ (–Ω–∞ –æ—Å–Ω–æ–≤–µ config_tlg_example.py)
‚îú‚îÄ‚îÄ logs/                  # –ª–æ–≥–∏
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ pyproject.toml
```

---

## üß© –ü–ª–∞–≥–∏–Ω—ã (plugins_bot)

–ö–∞–∂–¥—ã–π –ø–ª–∞–≥–∏–Ω ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ —Å —Ñ–∞–π–ª–æ–º `–∏–º—è_–ø–ª–∞–≥–∏–Ω–∞.py` –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `–∏–º—è_–ø–ª–∞–≥–∏–Ω–∞.md` (help).

**–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã:**
- `_core` ‚Äî –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã (–∑–∞–≥—Ä—É–∑–∫–∞/–≤—ã–≥—Ä—É–∑–∫–∞/—Å–ø–∏—Å–æ–∫ –ø–ª–∞–≥–∏–Ω–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º)
- `noauthbot` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- `inline_button` ‚Äî –ø—Ä–∏–º–µ—Ä inline-–∫–Ω–æ–ø–æ–∫
- `runner_questionnaire` ‚Äî –∞–Ω–∫–µ—Ç—ã –Ω–∞ JSON
- `runner_questionnaire_inline_button` ‚Äî –∞–Ω–∫–µ—Ç—ã —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏
- `setlang` ‚Äî —Å–º–µ–Ω–∞ —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è /setlang
- `start_cmd` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ /start
- `privet` ‚Äî –ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ —Å i18n

**–ü—Ä–∏–º–µ—Ä –ø–ª–∞–≥–∏–Ω–∞:**
```python
from telethon import events

@tlgbot.on(tlgbot.cmd('hi'))
async def handler(event):
    await event.reply('hey')
```

**Help –ø–æ –ø–ª–∞–≥–∏–Ω—É:**
- `/help –∏–º—è_–ø–ª–∞–≥–∏–Ω–∞` ‚Äî –ø–æ–∫–∞–∂–µ—Ç .md –∏–ª–∏ docstring

---

## –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞


–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/adduser` | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (–±–æ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç ID, –¥–æ–±–∞–≤–∏—Ç —Å —Ä–æ–ª—å—é user) |
| `/deluser` | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (–±–æ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç ID, —É–¥–∞–ª—è–µ—Ç –∏–∑ –ë–î, –∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–æ–≤) |
| `/listusers` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –±–æ—Ç—É |
| `/plugins` | –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º |
| `/load <plugin>` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/load privet`) |
| `/reload <plugin>` | –¢–æ –∂–µ, —á—Ç–æ –∏ `/load` |
| `/unload <plugin>` | –í—ã–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/unload privet`) |
| `/help <plugin>` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –ø–ª–∞–≥–∏–Ω—É (docstring –∏–ª–∏ .md) |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- –î–ª—è –∫–æ–º–∞–Ω–¥ `/adduser` –∏ `/deluser` –±–æ—Ç –≤–µ–¥—ë—Ç –¥–∏–∞–ª–æ–≥: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞.
- `/help <plugin>` –∏—â–µ—Ç —Ñ–∞–π–ª —Å–ø—Ä–∞–≤–∫–∏ `<plugin>.md` –∏–ª–∏ –≤—ã–≤–æ–¥–∏—Ç docstring, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.
- –ù–µ–ª—å–∑—è –≤—ã–≥—Ä—É–∑–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω `_core` (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫).
- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º (ID –∏–∑ `TLG_ADMIN_ID_CLIENT`).



---

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   git clone https://github.com/kaefik/py-tlgbotcore.git
   cd py-tlgbotcore
   uv sync
   # –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   uv sync --extra dev
   ```
2. **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥:**
   ```bash
   cp cfg/config_tlg_example.py cfg/config_tlg.py
   # –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è (API_ID, HASH, TOKEN, ADMINS...)
   ```
3. **–ó–∞–ø—É—Å–∫:**
    `uv run -m bot.start_tlgbotcore`

---

## üõ†Ô∏è –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

–ü—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Ç–µ—Å—Ç—ã:
```bash
uv run ruff check .        # –ª–∏–Ω—Ç–µ—Ä
uv run ruff format .       # –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç
uv run mypy bot/           # —Ç–∏–ø–∏–∑–∞—Ü–∏—è
uv run pytest              # —Ç–µ—Å—Ç—ã (–¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏)
```

---

## üê≥ Docker / Docker Compose

**Docker:**
```bash
docker build -t py-tlgbotcore .
docker run -d --name tlgbotcore --restart unless-stopped -v ./logs:/app/logs:z -v ./data:/app/data:z -v ./cfg/config_tlg.py:/app/cfg/config_tlg.py:z py-tlgbotcore

```


---

## üìù –ö–æ–Ω—Ñ–∏–≥ (cfg/config_tlg.py)

```python
TLG_APP_NAME = "your_app"
TLG_APP_API_ID = 12345678
TLG_APP_API_HASH = "your_hash"
I_BOT_TOKEN = "your_token"
TLG_ADMIN_ID_CLIENT = [123456789]
TYPE_DB = "SQLITE"  # –∏–ª–∏ "CSV"
SETTINGS_DB_PATH = "settings.db"
DEFAULT_LANG = "ru"
AVAILABLE_LANGS = {"ru": "–†—É—Å—Å–∫–∏–π", "en": "English", ...}
```

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Ñ–∏–≥–∞.

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- –ü–ª–∞–≥–∏–Ω—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã, –Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ 
- –í—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ã
- DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ª–∞–±–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ git!
- –î–ª—è production ‚Äî sandbox –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤, CI/CD, —Ç–µ—Å—Ç—ã

---

## üèÜ –ê–≤—Ç–æ—Ä –∏ –ª–∏—Ü–µ–Ω–∑–∏—è

- –ê–≤—Ç–æ—Ä: [kaefik](https://github.com/kaefik)
- –õ–∏—Ü–µ–Ω–∑–∏—è: MPL 2.0

