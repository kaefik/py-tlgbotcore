# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ py-tlgbotcore

## üîç –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

Telegram Bot Core - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–æ–≤ —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞–≥–∏–Ω–æ–≤ –Ω–∞ –±–∞–∑–µ Telethon. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫: Python 3.12+, uv –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏, ruff/mypy –¥–ª—è –ª–∏–Ω—Ç–∏–Ω–≥–∞.

---

## üö® –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 1. SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ (–í–´–°–û–ö–ò–ô –†–ò–°–ö)
**–§–∞–π–ª:** `bot/tlgbotcore/sqliteutils/sqliteutils.py`
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã - **–•–û–†–û–®–û**
- –í—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π

### 2. –•–∞—Ä–¥–∫–æ–¥ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `cfg/config_tlg_example.py`
- –°–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤ –∏ API –∫–ª—é—á–µ–π
- **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –ï—Å—Ç—å `.env.example` –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 3. –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π (–°–†–ï–î–ù–ò–ô –†–ò–°–ö)
**–§–∞–π–ª:** `bot/tlgbotcore/tlgbotcore.py:191-204`
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ `importlib`
- **–†–ò–°–ö:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –∏–∑ —Ñ–∞–π–ª–æ–≤ –ø–ª–∞–≥–∏–Ω–æ–≤
- **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –ø–µ—Å–æ—á–Ω–∏—Ü—É –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
**–§–∞–π–ª:** `bot/tlgbotcore/tlgbotcore.py`
- –ö–ª–∞—Å—Å `TlgBotCore` –¥–µ–ª–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î, –∑–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–†–ï–®–ï–ù–ò–ï:** –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

### 2. –ñ—ë—Å—Ç–∫–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ - –°–î–ï–õ–ê–ù–û
- –ü—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- **–†–ï–®–ï–ù–ò–ï:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π
- –ù–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è –ë–î (SQLite/CSV)
- **–†–ï–®–ï–ù–ò–ï:** –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã/–ø—Ä–æ—Ç–æ–∫–æ–ª—ã

### 4. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
**–§–∞–π–ª:** `bot/tlgbotcore/tlgbotcore.py:17-80`
- –ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `__init__` —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- **–†–ï–®–ï–ù–ò–ï:** –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ `async def _async_init()`

---

## üêõ –ü–†–û–ë–õ–ï–ú–´ –ö–ê–ß–ï–°–¢–í–ê –ö–û–î–ê

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º—ã:**
- `bot/tlgbotcore/_core.py:26` - `print()` –≤–º–µ—Å—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `bot/tlgbotcore/sqliteutils/sqliteutils.py:41,91` - `print()` –¥–ª—è –æ—à–∏–±–æ–∫
- –û–±—â–∏–µ `except Exception` –±–µ–∑ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–ï–®–ï–ù–ò–ï:**
```python
# –í–º–µ—Å—Ç–æ
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
except SpecificException as e:
    logger.error(f"–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
```

### 2. –¢–∏–ø–∏–∑–∞—Ü–∏—è
**–•–æ—Ä–æ—à–æ:**
- –ù–∞—Å—Ç—Ä–æ–µ–Ω mypy —Å –±–∞–∑–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è type hints –≤ –Ω–æ–≤–æ–º –∫–æ–¥–µ

**–ü—Ä–æ–±–ª–µ–º—ã:**
- `disallow_untyped_defs = false` - —Å–ª–∏—à–∫–æ–º –º—è–≥–∫–æ
- –ú–Ω–æ–≥–æ `ignore_errors = true` –≤ mypy –∫–æ–Ω—Ñ–∏–≥–µ

### 3. –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥
**–§–∞–π–ª:** `bot/tlgbotcore/tlgbotcore.py:82-92`
- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- **–†–ï–®–ï–ù–ò–ï:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É

### 4. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
**–§–∞–π–ª—ã:** `sqliteutils.py` –∏ `csvdbutils.py`
- –ü–æ—Ö–æ–∂–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–†–ï–®–ï–ù–ò–ï:** –í—ã–¥–µ–ª–∏—Ç—å –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üì¶ –ó–ê–í–ò–°–ò–ú–û–°–¢–ò –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### ‚úÖ –•–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
- `pyproject.toml` —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- `uv.lock` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã—Ö —Å–±–æ—Ä–æ–∫
- Ruff —Å —Ä–∞–∑—É–º–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
- Docker —Å multi-stage —Å–±–æ—Ä–∫–æ–π
- `.env.example` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### ‚ö†Ô∏è –£–ª—É—á—à–µ–Ω–∏—è:
- –î–æ–±–∞–≤–∏—Ç—å pre-commit —Ö—É–∫–∏
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Actions –¥–ª—è CI/CD
- –î–æ–±–∞–≤–∏—Ç—å coverage –æ—Ç—á—ë—Ç—ã

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ü—Ä–æ–±–ª–µ–º—ã:
- –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- Pytest –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
```python
# –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
tests/
‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ test_models.py
‚îÇ   ‚îú‚îÄ‚îÄ test_sqliteutils.py
‚îÇ   ‚îî‚îÄ‚îÄ test_tlgbotcore.py
‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îî‚îÄ‚îÄ test_plugin_loading.py
‚îî‚îÄ‚îÄ conftest.py
```

---

## üìù –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### ‚úÖ –ï—Å—Ç—å:
- README.md —Å –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- Docstrings –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- TODO.md –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û):
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–ª–∞–≥–∏–Ω–æ–≤** - –¥–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –ø–µ—Å–æ—á–Ω–∏—Ü—É
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `print()` –Ω–∞ `logger`
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û):
1. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ TlgBotCore** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
2. **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –ë–î** - –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è SQLite/CSV
3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –ø–µ—Ä–µ–Ω–æ—Å –ë–î –≤ async

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û):
1. **–¢–µ—Å—Ç—ã** - –ø–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
2. **CI/CD** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - API –∏ –ø—Ä–∏–º–µ—Ä—ã

---

## üìä –ú–ï–¢–†–ò–ö–ò –ö–ê–ß–ï–°–¢–í–ê

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|-------------|
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 6/10 | SQL –∑–∞—â–∏—â—ë–Ω, –Ω–æ –ø–ª–∞–≥–∏–Ω—ã - —Ä–∏—Å–∫ |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 5/10 | –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–ª–∞—Å—Å, –∂—ë—Å—Ç–∫–∏–µ —Å–≤—è–∑–∏ |
| –ö–æ–¥ | 7/10 | –•–æ—Ä–æ—à–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã |
| –¢–µ—Å—Ç—ã | 2/10 | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 4/10 | –ë–∞–∑–æ–≤–∞—è –µ—Å—Ç—å, –¥–µ—Ç–∞–ª—å–Ω–æ–π –Ω–µ—Ç |
| **–û–ë–©–ê–Ø** | **5.2/10** | –†–∞–±–æ—á–∏–π –ø—Ä–æ–µ–∫—Ç, –Ω—É–∂–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è |

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ —É–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫  
3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å DI –∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è–º–∏

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –æ—Å–Ω–æ–≤—É, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä—å—ë–∑–Ω–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
